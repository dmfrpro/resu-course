# Task 0

Тут без комментариев, основную функцию нашел, гидра ее хорошо декомпилировала. Программа падает, потому что `user_input` не аллоцирован.
![[assets/task0.png]]

# Task 1

Я ленивый и просто решил прочитать почарово все дерево условий - понятно было, что этот код - loop-unrolled версия `strcmp()` для всей строки.
![[assets/task1_ifs.png]]
Я просто решил вставить флаг, который у меня получился - все работает:
![[assets/task1.png]]

# Task 2

Переменная `__s` ссылалась на неизвестный `PTR_DAT_00104060`. В функции `main()` было понятно, что `__s` - строка, поэтому у `PTR_DAT_00104060` и внутри лежащего блока я поменял тип данных на `string`, после чего обнаружил зашифрованную строку:
![[assets/task2_str.png]]

Далее смотрим на код: у нас выполняется какой-то цикл, и после его выполнения `iVar5 == iVar4 + -1`. Если `iVar5 == 0x539` (то есть, `iVar5 == 1337`), значит `iVar4 == 1338`.
`0x52dU` это `1325` в десятичном представлении, пора писать скрипт на python, который xor'нет каждый символ в строке с `iVar4` и вычтет `0x52dU`:
![[assets/task2.png]]

# Task 4

Сначала мне удалось понять, что в итоге передо мной python, посмотрев строчки:
![[Pasted image 20231115235138.png]]

Погуглив, мне удалось понять, что питоновские бинари надо распаковывать, при этом у линукса в бинаре торчит много чего сжатого через zlib:
![[Pasted image 20231115235446.png]]

Погуглив, я нашел `pyinstxtractor.py` [скрипт](https://github.com/extremecoders-re/pyinstxtractor/blob/master/pyinstxtractor.py), он распаковал бинарь следующим образом:
![[Pasted image 20231115235548.png]]

Внутренности следующие:
![[Pasted image 20231115235620.png]]

Первым делом посмотрим `task_4.pyc` и вот ответ:
![[Pasted image 20231115235726.png]]

Программа завершилась без ошибок по Ctrl+C:
![[Pasted image 20231115235838.png]]

# Task 8

Я обрадовался, быстро узнав, что передо мной модуль для ядра linux, в котором вызывается некая функция `intro_read()`, вызывающая в себе уже известную всем `copy_to_user()`. Мне удалось сначала довести функцию до такого вида:
![[Pasted image 20231116012946.png]]

Перед нами две строки длиной 39 (с учетом null character), вторая состоит из "сырых" байтиков, предлагаю написать python скрипт для расшифрования. Во-первых, проверим, что строки действительно совпадают по длине через assert, а затем перепишем код уже на python:
![[Pasted image 20231116014014.png]]
